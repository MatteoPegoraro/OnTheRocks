<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OnTheRocks!</title>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.js"
      integrity="sha512-VGxuOMLdTe8EmBucQ5vYNoYDTGijqUsStF6eM7P3vA/cM1pqOwSBv/uxw94PhhJJn795NlOeKBkECQZ1gIzp6A=="
      crossorigin="anonymous"
    ></script>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    />
    <style>
      .btn:focus {
        box-shadow: none !important;
      }

      .btn {
        padding: 0;
      }

      @keyframes shake {
        0% {
          transform: translate(2px, 1px) rotate(0deg);
        }
        10% {
          transform: translate(-1px, -2px) rotate(-1deg);
        }
        20% {
          transform: translate(-3px, 0px) rotate(1deg);
        }
        30% {
          transform: translate(0px, 2px) rotate(0deg);
        }
        40% {
          transform: translate(1px, -1px) rotate(1deg);
        }
        50% {
          transform: translate(-1px, 2px) rotate(-1deg);
        }
        60% {
          transform: translate(-3px, 1px) rotate(0deg);
        }
        70% {
          transform: translate(2px, 1px) rotate(-1deg);
        }
        80% {
          transform: translate(-1px, -1px) rotate(1deg);
        }
        90% {
          transform: translate(2px, 2px) rotate(0deg);
        }
        100% {
          transform: translate(1px, -2px) rotate(-1deg);
        }
      }
      .shake:hover {
        animation-name: shake;
        animation-duration: 0.5s;
        transform-origin: 50% 50%;
        animation-iteration-count: infinite;
      }
      .shake {
        display: inline-block;
      }
    </style>
  </head>

  <body
    style="
      background: rgb(8, 0, 85);
      background: radial-gradient(
        circle,
        rgba(8, 0, 85, 1) 0%,
        rgba(60, 0, 85, 1) 100%
      );
    "
  >
    <div id="cocktail-page" class="container d-flex-column">
      <div
        id="logo"
        class="container d-flex justify-content-center align-items-center"
        style="padding: 0.5rem;"
      >
        <a href="/home"
          ><img src="./Untitled-1-14.png" alt="" style="max-width: 150px;"
        /></a>
        <h5 id="title" class="title" style="color: seashell; padding: 3rem;">
          <i>Citazioni</i>
        </h5>
      </div>
      <div class="container d-flex-columm">
        <div
          id="cocktail-div"
          class="d-flex-column justify-content-center rounded"
          style="background-color: rgba(245, 212, 212, 0.7); padding: 0.5rem;"
        >
          <div class="d-flex justify-content-evenly" style="padding: 1.5rem;">
            <div style="max-width: 300px;">
              <img
                id="image-cocktail"
                style="max-width: 200px; border-radius: 50%;"
                src=""
                alt=""
              />
            </div>

            <div
              class="d-flex-column justify-content-center px-4"
              style="flex-grow: 2;"
            >
              <h3 id="name-cocktail" class="text-start">
                Nome cocktail
              </h3>
              <div class="d-flex">
                <p id="desc-cocktail" style="overscroll-behavior-y: content;">
                  Placeholder
                </p>
              </div>
            </div>
            <div id="ingredients-carousel" class="d-flex-row"></div>
          </div>
        </div>
      </div>
    </div>

    <div
      id="random-button"
      class="d-flex justify-content-center"
      style="padding: 2rem;"
    >
      <button class="btn btn-disabled shake" onclick="showRandomCocktail()">
        <img
          src="./Cocktail_layout.png"
          alt=""
          style="width: 100px; height: 100px; margin-right: -20px;"
        />
      </button>
      <img
        src="./Cocktail_layout_1.png"
        alt=""
        style="max-width: 110px; margin-right: -70px;"
      />
    </div>
    <script>
      const urlParams = new URLSearchParams(location.search);
      const globalName = urlParams.get("search_value")
      const globalType = urlParams.get("search_type")

      // const drinkName = urlParams.get("name");
      // const ingrName = urlParams.get("ingr")

      // inizializzazione pagina iniziale (cocktail random) tramite axios e funzione utilizzata attraverso il bottone RANDOM
      function showRandomCocktail() {
        axios
          .get(`https://www.thecocktaildb.com/api/json/v1/1/random.php`)
          .then((response) => {
            let drink = response.data.drinks[0];

            // riempimento dati dell'html
            document.getElementById("image-cocktail").src = drink.strDrinkThumb;
            document.getElementById("name-cocktail").innerText = drink.strDrink;
            document.getElementById("desc-cocktail").innerText =
              drink.strInstructions;
            document.getElementById("desc-cocktail").innerText =
              drink.strInstructions;

            // lista ingredienti gestita "pulendo" il json (grazie Matteo e Ale <3)
            const arrIngr = [];
            for (const test in drink) {
              if (test.includes("strIngredient") && drink[test] !== null) {
                arrIngr.push(drink[test]);
              }
            }

            // quantità di ingredienti (UA GRAZIE CIRO)
            const arrIngrMeasure = [];
            for (const property in drink) {
              if (property.includes("strMeasure") && drink[property] !== "") {
                arrIngrMeasure.push(drink[property]);
              }
            }

            // stampa lista ingredienti e quantità (se presenti)
            const ingrList = document.getElementById("ingredients-carousel");
            let listIngr = "";
            arrIngr.forEach((ingredient, index) => {
              const currentIngrMeasure = arrIngrMeasure[index];
              if (currentIngrMeasure !== null) {
                listIngr += `<li>${ingredient}: ${currentIngrMeasure}</li>`;
              } else {
                listIngr += `<li>${ingredient}</li>`;
              }
            });
            ingrList.innerHTML = listIngr;
          });
      }
      
      // inizializzione pagina attraverso paramentro Nome del cocktail (attraverso il form in homepage.html)
      function getCocktailFromSearch() {
        axios
          .get(
            `https://www.thecocktaildb.com/api/json/v1/1/search.php?s=${globalName}`
          )
          .then((response) => {
            let drink = response.data.drinks[0];

            // riempimento dati dell'html
            document.getElementById("image-cocktail").src = drink.strDrinkThumb;
            document.getElementById("name-cocktail").innerText = drink.strDrink;
            document.getElementById("desc-cocktail").innerText =
              drink.strInstructions;
            document.getElementById("desc-cocktail").innerText =
              drink.strInstructions;

            // lista ingredienti gestita "pulendo" il json (grazie Matteo e Ale <3)
            const arrIngr = [];
            for (const test in drink) {
              if (test.includes("strIngredient") && drink[test] !== null) {
                arrIngr.push(drink[test]);
              }
            }

            // quantità di ingredienti (UA GRAZIE CIRO)
            const arrIngrMeasure = [];
            for (const property in drink) {
              if (property.includes("strMeasure") && drink[property] !== "") {
                arrIngrMeasure.push(drink[property]);
              }
            }

            // stampa lista ingredienti e quantità (se presenti)
            const ingrList = document.getElementById("ingredients-carousel");
            let listIngr = "";
            arrIngr.forEach((ingredient, index) => {
              const currentIngrMeasure = arrIngrMeasure[index];
              if (currentIngrMeasure !== null) {
                listIngr += `<li>${ingredient}: ${currentIngrMeasure}</li>`;
              } else {
                listIngr += `<li>${ingredient}</li>`;
              }
            });
            ingrList.innerHTML = listIngr;
          });
      }
      
      // inizializzione pagina attraverso paramentro Ingrediente del cocktail (attraverso il form in homepage.html)
      function getIngrsFromSearch() {
        axios
          .get(
            `https://www.thecocktaildb.com/api/json/v1/1/filter.php?i=${globalName}`
          )
          .then((response) => {
            let drink = response.data.drinks[0];

            // riempimento dati dell'html
            document.getElementById("image-cocktail").src = drink.strDrinkThumb;
            document.getElementById("name-cocktail").innerText = drink.strDrink;
            document.getElementById("desc-cocktail").innerText =
              drink.strInstructions;
            document.getElementById("desc-cocktail").innerText =
              drink.strInstructions;

            // lista ingredienti gestita "pulendo" il json (grazie Matteo e Ale <3)
            const arrIngr = [];
            for (const test in drink) {
              if (test.includes("strIngredient") && drink[test] !== null) {
                arrIngr.push(drink[test]);
              }
            }

            // quantità di ingredienti (UA GRAZIE CIRO)
            const arrIngrMeasure = [];
            for (const property in drink) {
              if (property.includes("strMeasure") && drink[property] !== "") {
                arrIngrMeasure.push(drink[property]);
              }
            }

            // stampa lista ingredienti e quantità (se presenti)
            const ingrList = document.getElementById("ingredients-carousel");
            let listIngr = "";
            arrIngr.forEach((ingredient, index) => {
              const currentIngrMeasure = arrIngrMeasure[index];
              if (currentIngrMeasure !== null) {
                listIngr += `<li>${ingredient}: ${currentIngrMeasure}</li>`;
              } else {
                listIngr += `<li>${ingredient}</li>`;
              }
            });
            ingrList.innerHTML = listIngr;
          });
    }


      if (globalName == null){
        showRandomCocktail();
      } else if(globalType == "ingr"){
        getIngrsFromSearch();
      } else if(globalType == "name") {
        getCocktailFromSearch();
      }


      // if (drinkName == null && ingrName == null){
      //   showRandomCocktail();
      // } else if(drinkName != null && ingrName == null) {
      //   getCocktailFromSearch()
      // } else if(drinkName == null && ingrName != null) {
      //   getIngrsFromSearch()
      // }
   </script>
  </body>
</html>
